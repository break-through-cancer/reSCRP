// Set new default font family and font color to mimic Bootstrap's default styling
(Chart.defaults.global.defaultFontFamily = "Nunito"),
  '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = "#858796";

var ctx = document.getElementById("PCFracBar");
var myCellChart = new Chart(ctx, {
  type: "bar",
  data: {
    labels: [
      "Pt02_PC",
      "Pt03_PC",
      "Pt04_PC",
      "Pt05_PC",
      "Pt11_PC",
      "Pt13_PC",
      "Pt19_PC",
      "Pt21_PC",
      "Pt22_PC",
      "Pt23_PC",
    ],
    datasets: [
      {
        label: "T",
        data: [
            0.468,
            0.506,
            0.119,
            0.833,
            0.210,
            0.500,
            0.445,
            0.681,
            0.672,
            0.509,
        ],
        cellNumber: [
            971,
            1693,
            321,
            1586,
            881,
            5272,
            3150,
            6461,
            3122,
            3607,
        ],
        backgroundColor: "#F8766Dcc",
      },
      {
        label: "B/Plasma",
        data: [
            0.015,
            0.032,
            0.007,
            0.022,
            0.021,
            0.029,
            0.081,
            0.155,
            0.112,
            0.117,
        ],
        cellNumber: [
            32,
            107,
            20,
            42,
            89,
            303,
            571,
            1475,
            520,
            831,
        ],
        backgroundColor: "#C49A00cc",
      },
      {
        label: "NK",
        data: [
            0.083,
            0.063,
            0.007,
            0.071,
            0.013,
            0.035,
            0.018,
            0.015,
            0.066,
            0.051,
        ],
        cellNumber: [
            172,
            212,
            20,
            135,
            56,
            374,
            130,
            142,
            308,
            359,
        ],
        backgroundColor: "#53B400cc",
      },
      {
        label: "Myeloid",
        data: [
            0.424,
            0.396,
            0.105,
            0.061,
            0.235,
            0.324,
            0.245,
            0.146,
            0.091,
            0.321,
        ],
        cellNumber: [
            878,
            1323,
            285,
            117,
            983,
            3416,
            1732,
            1389,
            422,
            2273,
        ],
        backgroundColor: "#00C094cc",
      },
      {
        label: "Stromal",
        data: [
            0.010,
            0.002,
            0.000,
            0.010,
            0.001,
            0.001,
            0.001,
            0.001,
            0.011,
            0.000,
        ],
        cellNumber: [
            20,
            7,
            0,
            20,
            5,
            12,
            9,
            6,
            52,
            2,
        ],
        backgroundColor: "#00B6EBcc",
      },
      {
        label: "Epithelial",
        data: [
            0.000,
            0.000,
            0.030,
            0.001,
            0.021,
            0.006,
            0.006,
            0.001,
            0.008,
            0.001,
        ],
        cellNumber: [
            0,
            0,
            81,
            1,
            86,
            66,
            44,
            12,
            37,
            4,
        ],
        backgroundColor: "#A58AFFcc",
      },
      {
        label: "Malignant",
        data: [
            0.000,
            0.001,
            0.731,
            0.002,
            0.498,
            0.105,
            0.204,
            0.000,
            0.040,
            0.001,
        ],
        cellNumber: [
            0,
            3,
            1977,
            4,
            2087,
            1103,
            1444,
            2,
            188,
            8,
        ],
        backgroundColor: "#FB61D7cc",
      },
    ],
  },
  options: {
    maintainAspectRatio: false,
    legend: {
      labels: {
        usePointStyle: false,
        boxWidth: 12,
      },
    },
    scales: {
      xAxes: [{ stacked: true }],
      yAxes: [
        {
          stacked: true,
          ticks: {
            beginAtZero: true,
            max: 1.0,
          },
        },
      ],
    },
    tooltips: {
      callbacks: {
        label: function (tooltipItem, data) {
          return [
            data.datasets[tooltipItem.datasetIndex].label +
              " fraction: " +
              data.datasets[tooltipItem.datasetIndex].data[
                tooltipItem.index
              ].toFixed(2),
            "Cell number: " +
              data.datasets[tooltipItem.datasetIndex].cellNumber[
                tooltipItem.index
              ],
          ];
        },
      },
    },
  },
});
