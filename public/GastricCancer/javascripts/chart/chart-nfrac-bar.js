// Set new default font family and font color to mimic Bootstrap's default styling
(Chart.defaults.global.defaultFontFamily = "Nunito"),
  '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = "#858796";

var ctx = document.getElementById("NFracBar");
var myCellChart = new Chart(ctx, {
  type: "bar",
  data: {
    labels: [
      "Pt01_N",
      "Pt05_N",
      "Pt09_N",
      "Pt10_N",
      "Pt12_N",
      "Pt13_N",
      "Pt14_N",
      "Pt15_N",
      "Pt16_N",
      "Pt17_N",
      "Pt18_N",
      "Pt19_N",
      "Pt20_N",
      "Pt21_N",
      "Pt22_N",
      "Pt23_N",
    ],
    datasets: [
      {
        label: "T",
        data: [
            0.144,
            0.307,
            0.255,
            0.502,
            0.501,
            0.051,
            0.203,
            0.385,
            0.315,
            0.836,
            0.293,
            0.446,
            0.363,
            0.531,
            0.317,
            0.005
        ],
        cellNumber: [
            62,
            271,
            157,
            1213,
            1271,
            161,
            771,
            2284,
            584,
            1323,
            589,
            358,
            622,
            1685,
            351,
            2,
        ],
        backgroundColor: "#F8766Dcc",
      },
      {
        label: "B/Plasma",
        data: [
            0.098,
            0.215,
            0.507,
            0.352,
            0.267,
            0.084,
            0.134,
            0.370,
            0.426,
            0.044,
            0.435,
            0.024,
            0.301,
            0.387,
            0.097,
            0.781,
        ],
        cellNumber: [
            42,
            190,
            312,
            850,
            678,
            264,
            507,
            2192,
            790,
            69,
            873,
            19,
            516,
            1227,
            107,
            306,
        ],
        backgroundColor: "#B79F00cc",
      },
      {
        label: "NK",
        data: [
            0.019,
            0.029,
            0.016,
            0.007,
            0.013,
            0.001,
            0.013,
            0.013,
            0.030,
            0.018,
            0.058,
            0.031,
            0.017,
            0.035,
            0.008,
            0.000,
        ],
        cellNumber: [
            8,
            26,
            10,
            17,
            33,
            3,
            50,
            78,
            55,
            29,
            116,
            25,
            30,
            110,
            9,
            0,
        ],
        backgroundColor: "#00BA38cc",
      },
      {
        label: "Myeloid",
        data: [
            0.019,
            0.068,
            0.031,
            0.025,
            0.039,
            0.002,
            0.011,
            0.066,
            0.015,
            0.004,
            0.067,
            0.097,
            0.017,
            0.014,
            0.014,
            0.023,
        ],
        cellNumber: [
            8,
            60,
            19,
            60,
            100,
            5,
            41,
            391,
            28,
            7,
            135,
            78,
            30,
            45,
            15,
            9,
        ],
        backgroundColor: "#00BFC4cc",
      },
      {
        label: "Stromal",
        data: [
            0.051,
            0.009,
            0.005,
            0.005,
            0.009,
            0.001,
            0.001,
            0.088,
            0.010,
            0.004,
            0.056,
            0.029,
            0.005,
            0.003,
            0.006,
            0.046,
        ],
        cellNumber: [
            22,
            8,
            3,
            12,
            24,
            4,
            4,
            521,
            19,
            6,
            113,
            23,
            9,
            8,
            7,
            18
        ],
        backgroundColor: "#619CFFcc",
      },
      {
        label: "Epithelial",
        data: [
            0.670,
            0.371,
            0.185,
            0.109,
            0.170,
            0.862,
            0.638,
            0.078,
            0.204,
            0.094,
            0.090,
            0.373,
            0.296,
            0.030,
            0.559,
            0.145,
        ],
        cellNumber: [
            288,
            328,
            114,
            262,
            430,
            2724,
            2420,
            461,
            378,
            148,
            181,
            299,
            508,
            96,
            619,
            57,
        ],
        backgroundColor: "#F564E3cc",
      },
    ],
  },
  options: {
    maintainAspectRatio: false,
    legend: {
      labels: {
        usePointStyle: false,
        boxWidth: 12,
      },
    },
    scales: {
      xAxes: [{ stacked: true }],
      yAxes: [
        {
          stacked: true,
          ticks: {
            beginAtZero: true,
            max: 1.0,
          },
        },
      ],
    },
    tooltips: {
      callbacks: {
        label: function (tooltipItem, data) {
          return [
            data.datasets[tooltipItem.datasetIndex].label +
              " fraction: " +
              data.datasets[tooltipItem.datasetIndex].data[
                tooltipItem.index
              ].toFixed(2),
            "Cell number: " +
              data.datasets[tooltipItem.datasetIndex].cellNumber[
                tooltipItem.index
              ],
          ];
        },
      },
    },
  },
});
