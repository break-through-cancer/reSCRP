// Set new default font family and font color to mimic Bootstrap's default styling
(Chart.defaults.global.defaultFontFamily = "Nunito"),
  '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = "#858796";

var ctx = document.getElementById("PRIFracBar");
var myCellChart = new Chart(ctx, {
  type: "bar",
  data: {
    labels: [
      "Pt01_PRI",
      "Pt02_PRI",
      "Pt03_PRI",
      "Pt04_PRI",
      "Pt05_PRI",
      "Pt09_PRI",
      "Pt10_PRI",
      "Pt12_PRI",
      "Pt13_PRI",
      "Pt14_PRI",
      "Pt15_PRI",
      "Pt16_PRI",
      "Pt17_PRI",
      "Pt18_PRI",
      "Pt19_PRI",
      "Pt20_PRI",
      "Pt21_PRI",
      "Pt22_PRI",
      "Pt23_PRI",
    ],
    datasets: [
      {
        label: "T",
        data: [
            0.356,
            0.335,
            0.475,
            0.114,
            0.238,
            0.817,
            0.711,
            0.146,
            0.427,
            0.324,
            0.421,
            0.253,
            0.410,
            0.498,
            0.331,
            0.442,
            0.339,
            0.211,
            0.236,
        ],
        cellNumber: [
            232,
            439,
            566,
            207,
            248,
            1126,
            2429,
            247,
            569,
            870,
            1750,
            859,
            729,
            292,
            340,
            1068,
            844,
            868,
            861,
        ],
        backgroundColor: "#F8766Dcc",
      },
      {
        label: "B/Plasma",
        data: [
            0.038,
            0.313,
            0.251,
            0.049,
            0.447,
            0.055,
            0.019,
            0.108,
            0.186,
            0.039,
            0.153,
            0.326,
            0.028,
            0.251,
            0.160,
            0.282,
            0.093,
            0.027,
            0.263,
        ],
        cellNumber: [
            25,
            411,
            299,
            89,
            466,
            76,
            65,
            183,
            248,
            104,
            637,
            1105,
            50,
            147,
            164,
            683,
            232,
            110,
            961,
        ],
        backgroundColor: "#C49A00cc",
      },
      {
        label: "NK",
        data: [
            0.043,
            0.028,
            0.072,
            0.013,
            0.015,
            0.072,
            0.058,
            0.005,
            0.023,
            0.057,
            0.025,
            0.040,
            0.113,
            0.038,
            0.058,
            0.032,
            0.043,
            0.032,
            0.038,
        ],
        cellNumber: [
            28,
            37,
            86,
            23,
            16,
            99,
            199,
            8,
            31,
            153,
            106,
            137,
            200,
            22,
            59,
            78,
            106,
            132,
            137,
        ],
        backgroundColor: "#53B400cc",
      },
      {
        label: "Myeloid",
        data: [
            0.353,
            0.146,
            0.119,
            0.046,
            0.037,
            0.023,
            0.070,
            0.242,
            0.047,
            0.097,
            0.136,
            0.044,
            0.325,
            0.097,
            0.234,
            0.110,
            0.360,
            0.025,
            0.336,
        ],
        cellNumber: [
            230,
            191,
            142,
            83,
            39,
            32,
            240,
            411,
            63,
            262,
            565,
            150,
            577,
            57,
            240,
            265,
            898,
            103,
            1227,
        ],
        backgroundColor: "#00C094cc",
      },
      {
        label: "Stromal",
        data: [
            0.092,
            0.011,
            0.019,
            0.023,
            0.034,
            0.006,
            0.105,
            0.136,
            0.075,
            0.001,
            0.012,
            0.007,
            0.041,
            0.005,
            0.081,
            0.023,
            0.071,
            0.001,
            0.018,
        ],
        cellNumber: [
            60,
            15,
            23,
            42,
            35,
            8,
            360,
            231,
            100,
            4,
            51,
            23,
            72,
            3,
            83,
            55,
            176,
            5,
            67,
        ],
        backgroundColor: "#00B6EBcc",
      },
      {
        label: "Epithelial",
        data: [
            0.031,
            0.163,
            0.045,
            0.568,
            0.229,
            0.009,
            0.000,
            0.242,
            0.186,
            0.480,
            0.067,
            0.290,
            0.042,
            0.109,
            0.135,
            0.073,
            0.043,
            0.016,
            0.065,
        ],
        cellNumber: [
            20,
            214,
            54,
            1034,
            239,
            12,
            0,
            411,
            248,
            1291,
            280,
            983,
            75,
            64,
            138,
            176,
            106,
            64,
            237,
        ],
        backgroundColor: "#A58AFFcc",
      },
      {
        label: "Malignant",
        data: [
            0.087,
            0.004,
            0.018,
            0.189,
            0.000,
            0.018,
            0.036,
            0.120,
            0.056,
            0.001,
            0.186,
            0.040,
            0.041,
            0.002,
            0.002,
            0.038,
            0.053,
            0.689,
            0.044,
        ],
        cellNumber: [
            57,
            5,
            22,
            344,
            0,
            25,
            124,
            204,
            74,
            4,
            772,
            135,
            73,
            1,
            2,
            93,
            131,
            2836,
            159,
        ],
        backgroundColor: "#FB61D7cc",
      },
    ],
  },
  options: {
    maintainAspectRatio: false,
    legend: {
      labels: {
        usePointStyle: false,
        boxWidth: 12,
      },
    },
    scales: {
      xAxes: [{ stacked: true }],
      yAxes: [
        {
          stacked: true,
          ticks: {
            beginAtZero: true,
            max: 1.0,
          },
        },
      ],
    },
    tooltips: {
      callbacks: {
        label: function (tooltipItem, data) {
          return [
            data.datasets[tooltipItem.datasetIndex].label +
              " fraction: " +
              data.datasets[tooltipItem.datasetIndex].data[
                tooltipItem.index
              ].toFixed(2),
            "Cell number: " +
              data.datasets[tooltipItem.datasetIndex].cellNumber[
                tooltipItem.index
              ],
          ];
        },
      },
    },
  },
});
