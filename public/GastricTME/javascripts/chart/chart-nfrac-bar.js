// Set new default font family and font color to mimic Bootstrap's default styling
(Chart.defaults.global.defaultFontFamily = "Nunito"),
  '-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif';
Chart.defaults.global.defaultFontColor = "#858796";

var ctx = document.getElementById("NFracBar");
var myCellChart = new Chart(ctx, {
  type: "bar",
  data: {
    labels: [
      "Pt01_N",
      "Pt05_N",
      "Pt09_N",
      "Pt10_N",
      "Pt12_N",
      "Pt13_N",
      "Pt14_N",
      "Pt15_N",
      "Pt16_N",
      "Pt17_N",
      "Pt18_N",
      "Pt19_N",
      "Pt20_N",
      "Pt21_N",
      "Pt22_N",
      "Pt23_N",
    ],
    datasets: [
      {
        label: "T",
        data: [
          0.144186046511628, 0.306908267270668, 0.255284552845528,
          0.502485501242751, 0.501182965299685, 0.0509332489718444,
          0.203269180068547, 0.385355154378269, 0.314994606256742,
          0.836283185840708, 0.293472845042352, 0.446384039900249,
          0.36268221574344, 0.531378114159571, 0.316787003610108,
          0.00510204081632653,
        ],
        cellNumber: [
          62, 271, 157, 1213, 1271, 161, 771, 2284, 584, 1323, 589, 358, 622,
          1685, 351, 2,
        ],
        backgroundColor: "#F8766Dcc",
      },
      {
        label: "B/Plasma",
        data: [
          0.0976744186046512, 0.215175537938845, 0.507317073170732,
          0.352112676056338, 0.267350157728707, 0.0835178740904777,
          0.133667281834959, 0.369832967774591, 0.426105717367853,
          0.0436156763590392, 0.434977578475336, 0.0236907730673317,
          0.300874635568513, 0.386944181646168, 0.0965703971119134,
          0.780612244897959,
        ],
        cellNumber: [
          42, 190, 312, 850, 678, 264, 507, 2192, 790, 69, 873, 19, 516, 1227,
          107, 306,
        ],
        backgroundColor: "#B79F00cc",
      },
      {
        label: "NK",
        data: [
          0.0186046511627907, 0.029445073612684, 0.016260162601626,
          0.00704225352112676, 0.01301261829653, 0.000949066751028156,
          0.0131821776957553, 0.0131601147292053, 0.0296655879180151,
          0.0183312262958281, 0.0577977080219233, 0.0311720698254364,
          0.0174927113702624, 0.0346893724377168, 0.00812274368231047, 0,
        ],
        cellNumber: [
          8, 26, 10, 17, 33, 3, 50, 78, 55, 29, 116, 25, 30, 110, 9, 0,
        ],
        backgroundColor: "#00BA38cc",
      },
      {
        label: "Myeloid",
        data: [
          0.0186046511627907, 0.0679501698754247, 0.0308943089430894,
          0.0248550124275062, 0.0394321766561514, 0.00158177791838026,
          0.0108093857105194, 0.0659692930656319, 0.0151024811218986,
          0.00442477876106195, 0.0672645739910314, 0.0972568578553616,
          0.0174927113702624, 0.0141911069063387, 0.0135379061371841,
          0.0229591836734694,
        ],
        cellNumber: [
          8, 60, 19, 60, 100, 5, 41, 391, 28, 7, 135, 78, 30, 45, 15, 9,
        ],
        backgroundColor: "#00BFC4cc",
      },
      {
        label: "Stromal",
        data: [
          0.0511627906976744, 0.00906002265005663, 0.0048780487804878,
          0.00497100248550124, 0.00946372239747634, 0.00126542233470421,
          0.00105457421566043, 0.0879028176143074, 0.0102481121898598,
          0.00379266750948167, 0.0563029397110115, 0.0286783042394015,
          0.00524781341107872, 0.00252286345001577, 0.00631768953068592,
          0.0459183673469388,
        ],
        cellNumber: [22, 8, 3, 12, 24, 4, 4, 521, 19, 6, 113, 23, 9, 8, 7, 18],
        backgroundColor: "#619CFFcc",
      },
      {
        label: "Epithelial",
        data: [
          0.669767441860465, 0.371460928652322, 0.185365853658537,
          0.108533554266777, 0.169558359621451, 0.861752609933565,
          0.638017400474558, 0.0777796524379956, 0.203883495145631,
          0.0935524652338812, 0.0901843547583458, 0.372817955112219,
          0.296209912536443, 0.0302743614001892, 0.558664259927798,
          0.145408163265306,
        ],
        cellNumber: [
          288, 328, 114, 262, 430, 2724, 2420, 461, 378, 148, 181, 299, 508, 96,
          619, 57,
        ],
        backgroundColor: "#F564E3cc",
      },
    ],
  },
  options: {
    maintainAspectRatio: false,
    legend: {
      labels: {
        usePointStyle: false,
        boxWidth: 12,
      },
    },
    scales: {
      xAxes: [{ stacked: true }],
      yAxes: [
        {
          stacked: true,
          ticks: {
            beginAtZero: true,
            max: 1.0,
          },
        },
      ],
    },
    tooltips: {
      callbacks: {
        label: function (tooltipItem, data) {
          return [
            data.datasets[tooltipItem.datasetIndex].label +
              " fraction: " +
              data.datasets[tooltipItem.datasetIndex].data[
                tooltipItem.index
              ].toFixed(2),
            "Cell number: " +
              data.datasets[tooltipItem.datasetIndex].cellNumber[
                tooltipItem.index
              ],
          ];
        },
      },
    },
  },
});
