// Set new default font family and font color to mimic Bootstrap's default styling
var pcolor1 = "#DA291C";
var pcolor2 = "#000000";
var pcolor3 = "#63666A";

var color1 = "#614B79";
var color2 = "#789D4A";
var color3 = "#407EC9";
var color4 = "#CB6015";
var color5 = "#F1B434";
var color6 = "#ED8B00";
var color7 = "#B7BF10";

var color1cc = "#614B79CC";
var color2cc = "#789D4ACC";
var color3cc = "#407EC9CC";
var color4cc = "#CB6015CC";
var color5cc = "#F1B434CC";
var color6cc = "#ED8B00CC";
var color7cc = "#B7BF10CC";

Chart.defaults.global.defaultFontFamily = "Nunito";
Chart.defaults.global.defaultFontColor = pcolor3;
var ctx = document.getElementById("CellFractionTumorBar");

var myCellFracChart = new Chart(ctx, {
    type: "bar",
    data: {
        labels: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
        datasets: [
            {
                label: 'MemB-1',
                backgroundColor: '#FBB4AE',
                data: [0.630769230769231,0.227476038338658,0.104922279792746,0.748333333333333,0.386792452830189,0.791666666666667,0.605577689243028,0.523809523809524,0.291666666666667,0.485690923957482,0.334268131183298,0.669401148482363,0.0407003532483489,0.463299328191092,0.65143224975861,0.214839094159714],
                cellNumber: [369,712,243,449,41,874,608,22,21,594,4291,816,265,1862,2024,721],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'MemB-2',
                backgroundColor: '#D9D9D9',
                data: [0.0136752136752137,0.00862619808306709,0.00302245250431779,0.0283333333333333,0.10377358490566,0.0380434782608696,0.049800796812749,0.0714285714285714,0.0277777777777778,0.0351594439901881,0.00895847939549739,0.0853158326497129,0.0121333128551682,0.0161731774073153,0.0460251046025105,0.0193682955899881],
                cellNumber: [8,27,7,17,11,42,50,3,2,43,115,104,79,65,143,65],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'NaiveB',
                backgroundColor: '#DECBE4',
                data: [0.0564102564102564,0.0150159744408946,0.00949913644214162,0.0216666666666667,0.0283018867924528,0.0597826086956522,0.195219123505976,0.0238095238095238,0.0277777777777778,0.156173344235487,0.0550751733271014,0.0385561936013126,0.00138227614805713,0.0266235381935805,0.096234309623431,0.00148986889153754],
                cellNumber: [33,47,22,13,3,66,196,1,2,191,707,47,9,107,299,5],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA1',
                backgroundColor: '#80B1D3',
                data: [0.11965811965812,0.271884984025559,0.334628670120898,0.095,0.19811320754717,0.0289855072463768,0.0547808764940239,0.119047619047619,0.277777777777778,0.143090760425184,0.331853236737556,0.0803937653814602,0.522346797726924,0.16596168201045,0.0531058899259736,0.477949940405244],
                cellNumber: [70,851,775,57,21,32,55,5,20,175,4260,98,3401,667,165,1604],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA2',
                backgroundColor: '#8DD3C7',
                data: [0.0222222222222222,0.10223642172524,0.149827288428325,0.00666666666666667,0.122641509433962,0.0036231884057971,0.0119521912350598,0.119047619047619,0.166666666666667,0.0228945216680294,0.0997117706629275,0.022149302707137,0.150360927660882,0.0213983578004479,0.00386224654007081,0.0274135876042908],
                cellNumber: [13,320,347,4,13,4,12,5,12,28,1280,27,979,86,12,92],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgD',
                backgroundColor: '#A65628',
                data: [0.00512820512820513,0.0162939297124601,0.00949913644214162,0.00166666666666667,0,0,0.00398406374501992,0,0.0277777777777778,0.00654129190515127,0.0131650697203396,0.00246103363412633,0.0241130394716633,0.000248818113958696,0.000643707756678468,0.064958283671037],
                cellNumber: [3,51,22,1,0,0,4,0,2,8,169,3,157,1,2,218],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG1',
                backgroundColor: '#BEAED4',
                data: [0.0512820512820513,0.133226837060703,0.172279792746114,0.0566666666666667,0.0660377358490566,0.0208333333333333,0.0627490039840637,0.0714285714285714,0.0416666666666667,0.098119378577269,0.0959725792630677,0.0385561936013126,0.134387958838888,0.196815128141329,0.0624396523978114,0.112336114421931],
                cellNumber: [30,417,399,34,7,23,63,3,3,120,1232,47,875,791,194,377],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG2',
                backgroundColor: '#8DA0CB',
                data: [0.0273504273504274,0.0862619808306709,0.0427461139896373,0.01,0.0471698113207547,0.00543478260869565,0.0119521912350598,0.0238095238095238,0.0277777777777778,0.0212591986917416,0.024382643919919,0.0410172272354389,0.051912148671479,0.0189101766608609,0.0305761184422272,0.033373063170441],
                cellNumber: [16,270,99,6,5,6,12,1,2,26,313,50,338,76,95,112],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG3',
                backgroundColor: '#FFD92F',
                data: [0.00683760683760684,0.0210862619808307,0.020293609671848,0.00666666666666667,0,0.0072463768115942,0.00099601593625498,0,0.0555555555555556,0.0106295993458708,0.0152683648827608,0.00656275635767022,0.0254953156197205,0.00348345359542175,0.00514966205342774,0.0104290822407628],
                cellNumber: [4,66,47,4,0,8,1,0,4,13,196,8,166,14,16,35],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgM',
                backgroundColor: '#FFFFB3',
                data: [0.0205128205128205,0.073482428115016,0.0112262521588946,0.005,0.0283018867924528,0.0199275362318841,0.00199203187250996,0.0476190476190476,0.0138888888888889,0.0122649223221586,0.00989327724546234,0.00246103363412633,0.0215020734142221,0.0189101766608609,0.0251046025104603,0.0342669845053635],
                cellNumber: [12,230,26,3,3,22,2,2,1,15,127,3,140,76,78,115],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasmablast',
                backgroundColor: '#6A3D9A',
                data: [0.00341880341880342,0.0060702875399361,0.000863557858376511,0.00166666666666667,0.00943396226415094,0.000905797101449275,0.00099601593625498,0,0,0.000817661488143908,0.00864688011217574,0.000820344544708778,0.0150514513899555,0.00323463548146305,0.000965561635017702,0.00119189511323004],
                cellNumber: [2,19,2,1,1,1,1,0,0,1,111,1,98,13,3,4],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Stressed plasma',
                backgroundColor: '#BC80BD',
                data: [0.0427350427350427,0.0383386581469649,0.14119170984456,0.0183333333333333,0.00943396226415094,0.0235507246376812,0,0,0.0416666666666667,0.00735895339329518,0.00280439354989484,0.0123051681706317,0.00061434495469206,0.0649415277432197,0.0244608947537818,0.00238379022646007],
                cellNumber: [25,120,327,11,1,26,0,0,3,9,36,15,4,261,76,8],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
        ],
    },
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: {
                left: 10,
                right: 25,
                top: 25,
                bottom: 0,
            },
        },
        plugins: {
            title: {
                display: true,
                text: "Cell fraction:",
            },
        },
        responsive: true,
        scales: {
            xAxes: [{ stacked: true }],
            yAxes: [
                {
                    stacked: true,
                    ticks: {
                        max: 1.0,
                    },
                },
            ],
        },
        legend: { display: true },
        tooltips: {
            callbacks: {
                label: function (tooltipItem, data) {
                    return [
                        "Cell type: " +
                            data.datasets[tooltipItem.datasetIndex].label,
                        "Cell fraction: " +
                            data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index].toFixed(2),
                        "Cell number: " +
                            data.datasets[tooltipItem.datasetIndex].cellNumber[tooltipItem.index],
                    ];
                },
            },
        },
    },
});
