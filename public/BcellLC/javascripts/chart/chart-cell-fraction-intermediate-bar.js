// Set new default font family and font color to mimic Bootstrap's default styling
var pcolor1 = "#DA291C";
var pcolor2 = "#000000";
var pcolor3 = "#63666A";

var color1 = "#614B79";
var color2 = "#789D4A";
var color3 = "#407EC9";
var color4 = "#CB6015";
var color5 = "#F1B434";
var color6 = "#ED8B00";
var color7 = "#B7BF10";

var color1cc = "#614B79CC";
var color2cc = "#789D4ACC";
var color3cc = "#407EC9CC";
var color4cc = "#CB6015CC";
var color5cc = "#F1B434CC";
var color6cc = "#ED8B00CC";
var color7cc = "#B7BF10CC";

Chart.defaults.global.defaultFontFamily = "Nunito";
Chart.defaults.global.defaultFontColor = pcolor3;
var ctx = document.getElementById("CellFractionIntermediateBar");

var myCellFracChart = new Chart(ctx, {
    type: "bar",
    data: {
        labels: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
        datasets: [
            {
                label: 'MemB-1',
                backgroundColor: '#FBB4AE',
                data: [0.182608695652174,0.313725490196078,0.428571428571429,0.494047619047619,0.505102040816326,0.527859237536657,0.571428571428571,0.325,0.0967741935483871,0.370098039215686,0.414893617021277,0.513698630136986,0.172932330827068,0.123222748815166,0.469387755102041],
                cellNumber: [21,16,12,83,99,180,12,13,12,151,117,75,92,26,46],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'MemB-2',
                backgroundColor: '#D9D9D9',
                data: [0.0173913043478261,0,0,0.0952380952380952,0.0102040816326531,0.0381231671554252,0.0476190476190476,0.025,0.0725806451612903,0.0514705882352941,0.117021276595745,0.0958904109589041,0.0996240601503759,0.0710900473933649,0.112244897959184],
                cellNumber: [2,0,0,16,2,13,1,1,9,21,33,14,53,15,11],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'NaiveB',
                backgroundColor: '#DECBE4',
                data: [0.0347826086956522,0.0196078431372549,0.178571428571429,0.0535714285714286,0.321428571428571,0.19941348973607,0.19047619047619,0.25,0.338709677419355,0.401960784313726,0.280141843971631,0.0958904109589041,0.184210526315789,0.530805687203792,0.183673469387755],
                cellNumber: [4,1,5,9,63,68,4,10,42,164,79,14,98,112,18],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA1',
                backgroundColor: '#80B1D3',
                data: [0.243478260869565,0.117647058823529,0.321428571428571,0.101190476190476,0.102040816326531,0.105571847507331,0.0476190476190476,0.175,0.225806451612903,0.0490196078431373,0.074468085106383,0.13013698630137,0.281954887218045,0.0805687203791469,0.142857142857143],
                cellNumber: [28,6,9,17,20,36,1,7,28,20,21,19,150,17,14],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA2',
                backgroundColor: '#8DD3C7',
                data: [0.0347826086956522,0.0392156862745098,0.0357142857142857,0.0297619047619048,0.0102040816326531,0.0381231671554252,0,0,0.00806451612903226,0.00245098039215686,0.0106382978723404,0.00684931506849315,0.0394736842105263,0.00947867298578199,0.0102040816326531],
                cellNumber: [4,2,1,5,2,13,0,0,1,1,3,1,21,2,1],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgD',
                backgroundColor: '#A65628',
                data: [0.0347826086956522,0,0,0.0119047619047619,0,0.00586510263929619,0.0952380952380952,0,0.032258064516129,0.00980392156862745,0.00709219858156028,0,0,0,0],
                cellNumber: [4,0,0,2,0,2,2,0,4,4,2,0,0,0,0],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG1',
                backgroundColor: '#BEAED4',
                data: [0.0782608695652174,0.372549019607843,0,0.101190476190476,0.0153061224489796,0.0527859237536657,0.0476190476190476,0.075,0.145161290322581,0.0514705882352941,0.0390070921985816,0.0684931506849315,0.129699248120301,0.0805687203791469,0.0204081632653061],
                cellNumber: [9,19,0,17,3,18,1,3,18,21,11,10,69,17,2],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG2',
                backgroundColor: '#8DA0CB',
                data: [0.0260869565217391,0.0392156862745098,0,0.0416666666666667,0,0.0117302052785924,0,0.125,0.0161290322580645,0.0122549019607843,0.024822695035461,0,0.0093984962406015,0.004739336492891,0.0204081632653061],
                cellNumber: [3,2,0,7,0,4,0,5,2,5,7,0,5,1,2],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG3',
                backgroundColor: '#FFD92F',
                data: [0.0956521739130435,0.0392156862745098,0.0357142857142857,0.0416666666666667,0.0153061224489796,0,0,0,0.0241935483870968,0.0245098039215686,0.0141843971631206,0.0479452054794521,0.0112781954887218,0.023696682464455,0],
                cellNumber: [11,2,1,7,3,0,0,0,3,10,4,7,6,5,0],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgM',
                backgroundColor: '#FFFFB3',
                data: [0.226086956521739,0,0,0.0238095238095238,0.0204081632653061,0.0175953079178886,0,0.025,0.0403225806451613,0.0196078431372549,0.0141843971631206,0.0136986301369863,0.0319548872180451,0.0473933649289099,0.0306122448979592],
                cellNumber: [26,0,0,4,4,6,0,1,5,8,4,2,17,10,3],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasmablast',
                backgroundColor: '#6A3D9A',
                data: [0.00869565217391304,0,0,0,0,0.00293255131964809,0,0,0,0.00490196078431373,0,0.0205479452054795,0.0338345864661654,0,0.0102040816326531],
                cellNumber: [1,0,0,0,0,1,0,0,0,2,0,3,18,0,1],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Stressed plasma',
                backgroundColor: '#BC80BD',
                data: [0.0173913043478261,0.0588235294117647,0,0.00595238095238095,0,0,0,0,0,0.00245098039215686,0.00354609929078014,0.00684931506849315,0.0056390977443609,0.028436018957346,0],
                cellNumber: [2,3,0,1,0,0,0,0,0,1,1,1,3,6,0],
                patients: ["P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
        ],
    },
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: {
                left: 10,
                right: 25,
                top: 25,
                bottom: 0,
            },
        },
        plugins: {
            title: {
                display: true,
                text: "Cell fraction:",
            },
        },
        responsive: true,
        scales: {
            xAxes: [{ stacked: true }],
            yAxes: [
                {
                    stacked: true,
                    ticks: {
                        max: 1.0,
                    },
                },
            ],
        },
        legend: { display: true },
        tooltips: {
            callbacks: {
                label: function (tooltipItem, data) {
                    return [
                        "Cell type: " +
                            data.datasets[tooltipItem.datasetIndex].label,
                        "Cell fraction: " +
                            data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index].toFixed(2),
                        "Cell number: " +
                            data.datasets[tooltipItem.datasetIndex].cellNumber[tooltipItem.index],
                    ];
                },
            },
        },
    },
});
