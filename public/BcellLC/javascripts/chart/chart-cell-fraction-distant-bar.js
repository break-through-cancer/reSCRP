// Set new default font family and font color to mimic Bootstrap's default styling
var pcolor1 = "#DA291C";
var pcolor2 = "#000000";
var pcolor3 = "#63666A";

var color1 = "#614B79";
var color2 = "#789D4A";
var color3 = "#407EC9";
var color4 = "#CB6015";
var color5 = "#F1B434";
var color6 = "#ED8B00";
var color7 = "#B7BF10";

var color1cc = "#614B79CC";
var color2cc = "#789D4ACC";
var color3cc = "#407EC9CC";
var color4cc = "#CB6015CC";
var color5cc = "#F1B434CC";
var color6cc = "#ED8B00CC";
var color7cc = "#B7BF10CC";

Chart.defaults.global.defaultFontFamily = "Nunito";
Chart.defaults.global.defaultFontColor = pcolor3;
var ctx = document.getElementById("CellFractionDistantBar");

var myCellFracChart = new Chart(ctx, {
    type: "bar",
    data: {
        labels: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
        datasets: [
            {
                label: 'MemB-1',
                backgroundColor: '#FBB4AE',
                data: [0.333333333333333,0.178343949044586,0.605769230769231,0.470588235294118,0.554545454545455,0.481481481481481,0.476190476190476,0.590909090909091,0.251748251748252,0.205882352941176,0.394366197183099,0.514285714285714,0.314031180400891,0.180094786729858,0.283950617283951],
                cellNumber: [18,28,63,16,122,52,100,26,36,42,84,198,141,38,23],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'MemB-2',
                backgroundColor: '#D9D9D9',
                data: [0,0.0127388535031847,0.115384615384615,0,0.0818181818181818,0.0555555555555556,0.0285714285714286,0,0.034965034965035,0.0441176470588235,0.0140845070422535,0.0961038961038961,0.160356347438753,0.0473933649289099,0.0617283950617284],
                cellNumber: [0,2,12,0,18,6,6,0,5,9,3,37,72,10,5],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'NaiveB',
                backgroundColor: '#DECBE4',
                data: [0.407407407407407,0.00636942675159236,0.0769230769230769,0.235294117647059,0.118181818181818,0.361111111111111,0.223809523809524,0.295454545454545,0.0559440559440559,0.254901960784314,0.300469483568075,0.0675324675324675,0.423162583518931,0.450236966824645,0.160493827160494],
                cellNumber: [22,1,8,8,26,39,47,13,8,52,64,26,190,95,13],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA1',
                backgroundColor: '#80B1D3',
                data: [0.185185185185185,0.343949044585987,0.0769230769230769,0.176470588235294,0.122727272727273,0.0462962962962963,0.19047619047619,0.0681818181818182,0.272727272727273,0.269607843137255,0.0938967136150235,0.137662337662338,0.0489977728285078,0.0947867298578199,0.234567901234568],
                cellNumber: [10,54,8,6,27,5,40,3,39,55,20,53,22,20,19],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA2',
                backgroundColor: '#8DD3C7',
                data: [0,0.0509554140127389,0,0.0588235294117647,0,0.00925925925925926,0.0238095238095238,0,0.0629370629370629,0,0.0140845070422535,0.0441558441558442,0.0022271714922049,0,0.0123456790123457],
                cellNumber: [0,8,0,2,0,1,5,0,9,0,3,17,1,0,1],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgD',
                backgroundColor: '#A65628',
                data: [0,0.0127388535031847,0,0.0294117647058824,0,0,0.00952380952380952,0.0227272727272727,0.013986013986014,0.0196078431372549,0,0,0,0,0.0123456790123457],
                cellNumber: [0,2,0,1,0,0,2,1,2,4,0,0,0,0,1],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG1',
                backgroundColor: '#BEAED4',
                data: [0.0740740740740741,0.171974522292994,0.0288461538461538,0.0294117647058824,0.0454545454545455,0.037037037037037,0.0142857142857143,0,0.132867132867133,0.117647058823529,0.131455399061033,0.0701298701298701,0.0378619153674833,0.0710900473933649,0.148148148148148],
                cellNumber: [4,27,3,1,10,4,3,0,19,24,28,27,17,15,12],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG2',
                backgroundColor: '#8DA0CB',
                data: [0,0.0382165605095541,0.0384615384615385,0,0.0227272727272727,0,0.0142857142857143,0,0.0629370629370629,0.0294117647058824,0.00469483568075117,0.0415584415584416,0.0066815144766147,0.037914691943128,0.037037037037037],
                cellNumber: [0,6,4,0,5,0,3,0,9,6,1,16,3,8,3],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG3',
                backgroundColor: '#FFD92F',
                data: [0,0.0700636942675159,0.00961538461538462,0,0,0,0.0142857142857143,0,0.048951048951049,0.0343137254901961,0.028169014084507,0.00779220779220779,0.0022271714922049,0.018957345971564,0.0246913580246914],
                cellNumber: [0,11,1,0,0,0,3,0,7,7,6,3,1,4,2],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgM',
                backgroundColor: '#FFFFB3',
                data: [0,0.0764331210191083,0.00961538461538462,0,0.0181818181818182,0,0.00476190476190476,0.0227272727272727,0.013986013986014,0.0196078431372549,0.0140845070422535,0.0181818181818182,0.0022271714922049,0.0616113744075829,0.0246913580246914],
                cellNumber: [0,12,1,0,4,0,1,1,2,4,3,7,1,13,2],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Plasmablast',
                backgroundColor: '#6A3D9A',
                data: [0,0,0.0192307692307692,0,0.0272727272727273,0,0,0,0,0,0.00469483568075117,0,0.0022271714922049,0,0],
                cellNumber: [0,0,2,0,6,0,0,0,0,0,1,0,1,0,0],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
            {
                label: 'Stressed plasma',
                backgroundColor: '#BC80BD',
                data: [0,0.0382165605095541,0.0192307692307692,0,0.00909090909090909,0.00925925925925926,0,0,0.048951048951049,0.00490196078431373,0,0.0025974025974026,0,0.037914691943128,0],
                cellNumber: [0,6,2,0,2,1,0,0,7,1,0,1,0,8,0],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P14","P15","P16"],
            },
        ],
    },
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: {
                left: 10,
                right: 25,
                top: 25,
                bottom: 0,
            },
        },
        plugins: {
            title: {
                display: true,
                text: "Cell fraction (Distant):",
            },
        },
        responsive: true,
        scales: {
            xAxes: [{ stacked: true }],
            yAxes: [
                {
                    stacked: true,
                    ticks: {
                        max: 1.0,
                    },
                },
            ],
        },
        legend: { display: true },
        tooltips: {
            callbacks: {
                label: function (tooltipItem, data) {
                    return [
                        "Cell type: " +
                            data.datasets[tooltipItem.datasetIndex].label,
                        "Cell fraction: " +
                            data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index].toFixed(2),
                        "Cell number: " +
                            data.datasets[tooltipItem.datasetIndex].cellNumber[tooltipItem.index],
                    ];
                },
            },
        },
    },
});
