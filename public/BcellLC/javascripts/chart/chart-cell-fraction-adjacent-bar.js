// Set new default font family and font color to mimic Bootstrap's default styling
var pcolor1 = "#DA291C";
var pcolor2 = "#000000";
var pcolor3 = "#63666A";

var color1 = "#614B79";
var color2 = "#789D4A";
var color3 = "#407EC9";
var color4 = "#CB6015";
var color5 = "#F1B434";
var color6 = "#ED8B00";
var color7 = "#B7BF10";

var color1cc = "#614B79CC";
var color2cc = "#789D4ACC";
var color3cc = "#407EC9CC";
var color4cc = "#CB6015CC";
var color5cc = "#F1B434CC";
var color6cc = "#ED8B00CC";
var color7cc = "#B7BF10CC";

Chart.defaults.global.defaultFontFamily = "Nunito";
Chart.defaults.global.defaultFontColor = pcolor3;
var ctx = document.getElementById("CellFractionAdjacentBar");

var myCellFracChart = new Chart(ctx, {
    type: "bar",
    data: {
        labels: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
        datasets: [
            {
                label: 'MemB-1',
                backgroundColor: '#FBB4AE',
                data: [0.25,0.0476190476190476,0.395348837209302,0.584615384615385,0.590643274853801,0.486486486486487,0.423931623931624,0.545454545454545,0.502994011976048,0.173333333333333,0.305343511450382,0.37037037037037,0.372549019607843,0.249388753056235,0.133858267716535,0.288888888888889],
                cellNumber: [5,3,17,38,101,36,248,12,84,26,80,40,19,102,17,39],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'MemB-2',
                backgroundColor: '#D9D9D9',
                data: [0,0,0,0.0615384615384615,0.12280701754386,0.0405405405405405,0.0376068376068376,0,0.0179640718562874,0.0666666666666667,0.114503816793893,0.12962962962963,0.117647058823529,0.0806845965770171,0.0551181102362205,0],
                cellNumber: [0,0,0,4,21,3,22,0,3,10,30,14,6,33,7,0],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'NaiveB',
                backgroundColor: '#DECBE4',
                data: [0.1,0,0,0.138461538461538,0.111111111111111,0.432432432432432,0.2,0.454545454545455,0.0479041916167665,0.393333333333333,0.316793893129771,0.287037037037037,0.0980392156862745,0.273838630806846,0.393700787401575,0.0148148148148148],
                cellNumber: [2,0,0,9,19,32,117,10,8,59,83,31,5,112,50,2],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA1',
                backgroundColor: '#80B1D3',
                data: [0.15,0.365079365079365,0.325581395348837,0.0307692307692308,0.0760233918128655,0.027027027027027,0.147008547008547,0,0.18562874251497,0.12,0.0877862595419847,0.0740740740740741,0.215686274509804,0.210268948655257,0.165354330708661,0.4],
                cellNumber: [3,23,14,2,13,2,86,0,31,18,23,8,11,86,21,54],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgA2',
                backgroundColor: '#8DD3C7',
                data: [0,0.0634920634920635,0.0232558139534884,0.0153846153846154,0.0175438596491228,0,0.0376068376068376,0,0.029940119760479,0.0133333333333333,0.0114503816793893,0.037037037037037,0.0588235294117647,0.0440097799511002,0.015748031496063,0.0296296296296296],
                cellNumber: [0,4,1,1,3,0,22,0,5,2,3,4,3,18,2,4],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgD',
                backgroundColor: '#A65628',
                data: [0,0.0158730158730159,0,0,0,0,0.0102564102564103,0,0.0119760479041916,0,0.00381679389312977,0,0,0,0.0078740157480315,0.0148148148148148],
                cellNumber: [0,1,0,0,0,0,6,0,2,0,1,0,0,0,1,2],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG1',
                backgroundColor: '#BEAED4',
                data: [0.25,0.126984126984127,0.209302325581395,0.0461538461538462,0.0350877192982456,0.0135135135135135,0.116239316239316,0,0.0479041916167665,0.166666666666667,0.0877862595419847,0.0277777777777778,0.0196078431372549,0.0684596577017115,0.0866141732283465,0.111111111111111],
                cellNumber: [5,8,9,3,6,1,68,0,8,25,23,3,1,28,11,15],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG2',
                backgroundColor: '#8DA0CB',
                data: [0,0.126984126984127,0.0232558139534884,0.0461538461538462,0,0,0.011965811965812,0,0.0898203592814371,0.02,0.00381679389312977,0.0555555555555556,0.0196078431372549,0.0171149144254279,0.031496062992126,0.0740740740740741],
                cellNumber: [0,8,1,3,0,0,7,0,15,3,1,6,1,7,4,10],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgG3',
                backgroundColor: '#FFD92F',
                data: [0.05,0.0793650793650794,0.0232558139534884,0.0153846153846154,0.0233918128654971,0,0.00512820512820513,0,0.0179640718562874,0.02,0.0343511450381679,0.00925925925925926,0.0588235294117647,0.0097799511002445,0.0236220472440945,0.00740740740740741],
                cellNumber: [1,5,1,1,4,0,3,0,3,3,9,1,3,4,3,1],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasma-IgM',
                backgroundColor: '#FFFFB3',
                data: [0.1,0.126984126984127,0,0.0153846153846154,0.0175438596491228,0,0.00854700854700855,0,0,0,0.0267175572519084,0,0.0196078431372549,0.0415647921760391,0.078740157480315,0.0518518518518519],
                cellNumber: [2,8,0,1,3,0,5,0,0,0,7,0,1,17,10,7],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Plasmablast',
                backgroundColor: '#6A3D9A',
                data: [0,0,0,0.0153846153846154,0,0,0,0,0,0,0.00381679389312977,0,0.0196078431372549,0,0,0],
                cellNumber: [0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
            {
                label: 'Stressed plasma',
                backgroundColor: '#BC80BD',
                data: [0.1,0.0476190476190476,0,0.0307692307692308,0.00584795321637427,0,0.00170940170940171,0,0.0479041916167665,0.0266666666666667,0.00381679389312977,0.00925925925925926,0,0.00488997555012225,0.0078740157480315,0.00740740740740741],
                cellNumber: [2,3,0,2,1,0,1,0,8,4,1,1,0,2,1,1],
                patients: ["P1","P2","P3","P4","P5","P6","P7","P8","P9","P10","P11","P12","P13","P14","P15","P16"],
            },
        ],
    },
    options: {
        maintainAspectRatio: false,
        layout: {
            padding: {
                left: 10,
                right: 25,
                top: 25,
                bottom: 0,
            },
        },
        plugins: {
            title: {
                display: true,
                text: "Cell fraction:",
            },
        },
        responsive: true,
        scales: {
            xAxes: [{ stacked: true }],
            yAxes: [
                {
                    stacked: true,
                    ticks: {
                        max: 1.0,
                    },
                },
            ],
        },
        legend: { display: true },
        tooltips: {
            callbacks: {
                label: function (tooltipItem, data) {
                    return [
                        "Cell type: " +
                            data.datasets[tooltipItem.datasetIndex].label,
                        "Patient: " +
                            data.datasets[tooltipItem.datasetIndex].stack,
                        "Cell fraction: " +
                            data.datasets[tooltipItem.datasetIndex].data[
                                tooltipItem.index
                            ].toFixed(2),
                        "Cell number: " +
                            data.datasets[tooltipItem.datasetIndex].cellNumber[
                                tooltipItem.index
                            ],
                    ];
                },
            },
        },
    },
});
